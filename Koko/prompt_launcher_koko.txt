# ğŸ§  Prompt Maestro para Copilot â€” CreaciÃ³n del Lanzador Oficial de Koko Browser (Koko Launcher)

Eres el ingeniero principal del proyecto **Koko Browser**.  
Quiero que diseÃ±es y desarrolles un **lanzador independiente (Koko Launcher)** que gestione la instalaciÃ³n, actualizaciÃ³n, validaciÃ³n y ejecuciÃ³n de la aplicaciÃ³n principal **Koko Browser**, segÃºn la arquitectura actual documentada en ARQUITECTURA.md.

---

# ğŸ¯ Objetivos del Launcher

1. Separar el sistema de actualizaciÃ³n de la app principal (Electron) en una aplicaciÃ³n independiente llamada **Koko Launcher**.
2. El launcher debe:
   - Verificar si hay actualizaciones disponibles (consultando GitHub Releases o un endpoint remoto).
   - Descargar las nuevas versiones de Koko Browser (usando `latest.yml` y archivos `.exe` / `.blockmap`).
   - Validar integridad (checksum o hash del archivo descargado).
   - Instalar o reemplazar la versiÃ³n anterior de manera segura.
   - Mostrar progreso visual (descarga, validaciÃ³n, instalaciÃ³n).
   - Lanzar la app principal (`KokoBrowser.exe`) una vez actualizada.
3. Debe funcionar tanto en modo **standalone** como **integrado** dentro del entorno actual de distribuciÃ³n (NSIS + electron-builder).
4. Mantener la coherencia visual y tÃ©cnica con la arquitectura de Koko Browser (React + TailwindCSS + Electron + TypeScript).

---

# ğŸ§© Requisitos de IntegraciÃ³n con la Arquitectura Actual

- **UbicaciÃ³n recomendada:** crear una nueva carpeta raÃ­z `KokoLauncher/` paralela a `Koko/`.
- **Stack tecnolÃ³gico:** usar **Electron + React + TailwindCSS**, igual que el navegador.
- **ComunicaciÃ³n entre Launcher y Browser:**
  - El launcher ejecutarÃ¡ `KokoBrowser.exe` tras verificar o actualizar.
  - GuardarÃ¡ logs y estado de actualizaciÃ³n en `resources/launcher/logs/`.
- **Compatibilidad:** debe poder actualizar tambiÃ©n componentes adicionales:
  - **MariaDB** (servicio local de base de datos)
  - **HeidiSQL** (interfaz grÃ¡fica de base de datos)
  - Archivos de configuraciÃ³n global (`resources/config.json`).
- **Seguridad:** validar integridad y firmas antes de reemplazar cualquier versiÃ³n.
- **UI:** mantener estilo **glassmorphism** y colores base de Tailwind usados en Koko Browser.

---

# ğŸ–¥ï¸ Estructura esperada del proyecto

KokoLauncher/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ProgressBar.tsx        # Barra de progreso con animaciÃ³n
â”‚   â”‚   â”œâ”€â”€ VersionInfo.tsx        # InformaciÃ³n de versiÃ³n local/remota
â”‚   â”‚   â”œâ”€â”€ UpdateButton.tsx       # BotÃ³n â€œActualizar / Iniciarâ€
â”‚   â”‚   â””â”€â”€ LogViewer.tsx          # Visualizador de logs del launcher
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ UpdateService.ts       # Descarga y validaciÃ³n de builds
â”‚   â”‚   â”œâ”€â”€ VersionService.ts      # ComparaciÃ³n de versiones locales/remotas
â”‚   â”‚   â”œâ”€â”€ IntegrityService.ts    # VerificaciÃ³n de checksums
â”‚   â”‚   â””â”€â”€ LaunchService.ts       # EjecuciÃ³n de KokoBrowser.exe
â”‚   â”œâ”€â”€ utils/
â”‚   â”‚   â””â”€â”€ FileUtils.ts           # Lectura/escritura segura de archivos
â”‚   â”œâ”€â”€ main.tsx                   # Punto de entrada React
â”‚   â””â”€â”€ App.tsx                    # UI principal del launcher
â”‚
â”œâ”€â”€ electron/
â”‚   â”œâ”€â”€ main.js                    # Proceso principal del launcher
â”‚   â”œâ”€â”€ preload.js                 # Bridge seguro main â†” renderer
â”‚   â””â”€â”€ updater/                   # LÃ³gica de actualizaciÃ³n
â”‚       â”œâ”€â”€ fetchUpdate.js
â”‚       â”œâ”€â”€ applyUpdate.js
â”‚       â”œâ”€â”€ validateFiles.js
â”‚       â””â”€â”€ launchApp.js
â”‚
â”œâ”€â”€ resources/
â”‚   â”œâ”€â”€ icons/                     # Iconos del launcher
â”‚   â””â”€â”€ config/                    # ConfiguraciÃ³n de actualizaciÃ³n
â”‚       â”œâ”€â”€ update.json            # URLs y versiÃ³n actual
â”‚       â””â”€â”€ channels.json          # Canales (stable, beta, dev)
â”‚
â””â”€â”€ package.json                   # Scripts, dependencias, build

---

# ğŸš€ Funcionalidades del Launcher

## ğŸ” 1. VerificaciÃ³n de versiones
- Compara la versiÃ³n local (`resources/config/update.json`) con la versiÃ³n mÃ¡s reciente publicada en GitHub Releases.
- Soporta canales de actualizaciÃ³n: `stable`, `beta`, `dev`.
- Usa la API de GitHub o un servidor remoto JSON.

## ğŸ“¥ 2. Descarga y validaciÃ³n
- Descarga los archivos de actualizaciÃ³n (`.exe` o `.blockmap`) segÃºn el sistema actual de `electron-updater`.
- Muestra una barra de progreso con porcentaje, velocidad y tiempo estimado.
- Valida el hash SHA256 antes de aplicar la actualizaciÃ³n.

## ğŸ§° 3. InstalaciÃ³n segura
- Si la app estÃ¡ en ejecuciÃ³n, solicita cerrarla antes de reemplazar archivos.
- Copia los archivos de actualizaciÃ³n a la carpeta `dist-electron/win-unpacked`.
- Actualiza el archivo `latest.yml` local tras instalaciÃ³n exitosa.

## â–¶ï¸ 4. EjecuciÃ³n
- Una vez completada la actualizaciÃ³n (o si no hay actualizaciones):
  - Ejecuta `KokoBrowser.exe` desde la ruta local.
  - Cierra el launcher tras verificar el proceso principal activo.

## ğŸ§  5. Logs y diagnÃ³stico
- Registrar todas las acciones del launcher en `resources/launcher/logs/launcher.log`.
- Mostrar logs en tiempo real dentro del componente `LogViewer.tsx`.

---

# ğŸ¨ Interfaz del Usuario

- Pantalla principal con:
  - Logo de Koko y versiÃ³n actual.
  - Texto de estado (â€œComprobando actualizacionesâ€¦â€, â€œDescargandoâ€¦â€, â€œListoâ€).
  - Barra de progreso animada.
  - BotÃ³n dinÃ¡mico: `Actualizar`, `Reintentar`, `Iniciar`.
  - Panel de logs expandible (toggle).
- Animaciones fluidas usando Tailwind + Framer Motion.
- Tema visual coherente con Koko Browser (glassmorphism, gradientes suaves, sombras 2xl).

---

# ğŸ” Seguridad y ValidaciÃ³n

- Validar SHA256 o firma digital antes de instalar actualizaciones.
- Comprobar permisos administrativos si se requiere reemplazar archivos del sistema.
- Evitar descargas parciales o corruptas (hash check obligatorio).
- Mantener aislamiento de procesos (no compartir contexto con el main de Koko Browser).

---

# ğŸ§© IntegraciÃ³n con el Sistema Existente

- El instalador NSIS incluirÃ¡:
  - `KokoLauncher.exe` (entry point)
  - `KokoBrowser/` (app principal)
  - `resources/` (archivos compartidos)
- El launcher podrÃ¡ ejecutarse automÃ¡ticamente tras cada actualizaciÃ³n del navegador.
- Permitir actualizaciones completas del ecosistema:
  - Koko Browser
  - MariaDB
  - HeidiSQL
  - Archivos de configuraciÃ³n (`config.json`)
- Compatibilidad total con `electron-builder` y `auto-update` interno para parches menores.

---

# ğŸª¶ Scripts de build esperados

En `package.json` del launcher:

- `"dev"` â€” Modo desarrollo (Vite + Electron con hot reload)
- `"build"` â€” Compila frontend con Vite
- `"dist"` â€” Empaqueta launcher completo con electron-builder
- `"start:browser"` â€” Lanza la aplicaciÃ³n Koko Browser desde el launcher
- `"publish"` â€” Publica versiÃ³n del launcher en GitHub o servidor de actualizaciones

---

# ğŸ“˜ Requisitos adicionales

- Documentar todo en `LAUNCHER.md` dentro del repositorio.
- Asegurar compatibilidad con versiones futuras de Electron.
- Garantizar que las rutas del launcher detecten automÃ¡ticamente la ubicaciÃ³n de Koko Browser.
- Soportar ejecuciÃ³n sin internet (modo offline).
- Ofrecer opciÃ³n de forzar actualizaciÃ³n manual (â€œRevisar actualizaciones ahoraâ€).

---

# ğŸ¯ Objetivo Final

Crear **Koko Launcher**, una aplicaciÃ³n moderna, segura y visualmente coherente con Koko Browser,  
capaz de gestionar actualizaciones, validaciones y el inicio del navegador principal.  

El resultado debe ser un sistema de actualizaciÃ³n robusto similar a los launchers de juegos modernos (Genshin Impact, Wuthering Waves o Epic Games Launcher),  
pero optimizado para el ecosistema de Koko (Electron + React + Tailwind + TypeScript + GitHub Releases + MariaDB local).
